Sub ConvertToMarkdownWithWeights()
    Dim cell As Range
    Dim lines As Variant
    Dim output As String
    Dim i As Integer
    Dim parts() As String
    Dim term As String
    Dim weight As String
    
    For Each cell In Selection
        If cell.Value <> "" Then
            lines = Split(cell.Value, vbLf)
            output = "| Term | Weight |" & vbCrLf & "|------|--------|" & vbCrLf
            For i = LBound(lines) To UBound(lines)
                parts = Split(Trim(lines(i)))
                If UBound(parts) >= 0 Then
                    weight = parts(UBound(parts))
                    term = Join(Application.Index(parts, 0, 0), " ", , UBound(parts))
                    term = Trim(Replace(lines(i), weight, ""))
                    output = output & "| " & term & " | " & weight & " |" & vbCrLf
                End If
            Next i
            cell.Offset(0, 1).Value = output ' Output to the adjacent column
        End If
    Next cell
End Sub
