Sub ConvertToMarkdownTermAndWeight()
    Dim cell As Range
    Dim lines As Variant
    Dim output As String
    Dim i As Integer
    Dim line As String
    Dim lastSpacePos As Long
    Dim term As String
    Dim weight As String

    For Each cell In Selection
        If cell.Value <> "" Then
            lines = Split(cell.Value, vbLf)
            output = "| Term | Weight |" & vbCrLf & "|------|--------|" & vbCrLf
            For i = LBound(lines) To UBound(lines)
                line = Trim(lines(i))
                If line <> "" Then
                    ' Find the last space to separate term and weight
                    lastSpacePos = InStrRev(line, " ")
                    If lastSpacePos > 0 Then
                        term = Trim(Left(line, lastSpacePos - 1))
                        weight = Trim(Mid(line, lastSpacePos + 1))
                        output = output & "| " & term & " | " & weight & " |" & vbCrLf
                    End If
                End If
            Next i
            cell.Offset(0, 1).Value = output ' Output to column to the right
        End If
    Next cell
End Sub
